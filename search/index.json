[{"content":"1.配置snmptrap 安装snmp相关工具\n1 yum install -y net-snmp* 官网下载源码，复制misc/snmptrap/zabbix_trap_receiver.pl，确认其中SNMPTrapperFile路径并授权\n1 2 3 vim /usr/bin/zabbix_trap_receiver.pl $SNMPTrapperFile = \u0026#39;/tmp/zabbix_traps.tmp\u0026#39;; chmod a+x /usr/bin/zabbix_trap_receiver.pl 配置zabbix服务器的snmptrap配置并启动(以团体字为public为例) vim /etc/snmp/snmptrapd.conf\n1 2 authCommunity log,execute,net public perl do \u0026#34;/usr/bin/zabbix_trap_receiver.pl\u0026#34; 1 2 3 systemctl restart snmptrapd systemctl enable snmptrapd systemctl status snmptrapd 配置zabbix服务器的zabbix_server.conf配置。启动snmptrap,修改SNMPTrapperFile，保持与zabbix_trap_receiver.pl中一致\n1 2 StartSNMPTrapper=1 SNMPTrapperFile=/tmp/zabbix_traps.tmp 1 2 systemctl restart zabbix-server systemctl status zabbix-server zabbix服务器防火墙放开snmptrap端口\n1 2 firewall-cmd --permanent --zone=public --add-service=snmptrap firewall-cmd --reload snmptrap测试 zabbix服务器上测试\n1 snmptrap -v 2c -c public 127.0.0.1 \u0026#39;\u0026#39; .1.3.6.1.2.1.33.1.6.3.21 .1.3.6.1.2.1.33.1.6.3.21 s \u0026#39;snmptrap test-v2\u0026#39; 客户端测试\n1 2 snmptrap -v 2c -c public zabbix-ip \u0026#39;\u0026#39; .1.3.6.1.2.1.33.1.6.3.21 .1.3.6.1.2.1.33.1.6.3.21 s \u0026#39;snmptrap test-v2\u0026#39; snmptrap -v 1 -c public zabbix-ip 1.3.6.1.2.1.33 zabbix-ip 6 0 999 1.3.6.1.2.1.33.1.6.3.21 s snmptrap-test-v1 验证\n1 tail /tmp/zabbix_traps.tmp 2.配置告警(以模板UPS RFC 1628 SNMP为例) 创建监控项\n1 2 3 4 5 6 名称：SNMP traps (fallback) 类型：SNMP trap 键值：snmptrap.fallback 信息类型：日志 日志时间格式：hh:mm:sszyyyy/MM/dd # 键值配置为snmptrap.fallback，可以接收所有未配置成SNMPtrap监控项的设备发出的trap信息 创建触发器,只要接受到新的trap信息就触发告警\n1 2 3 触发器名称 snmptrap event 表达式 length(last(/UPS RFC 1628 SNMP/snmptrap.fallback))\u0026gt;0 允许手动关闭 3.解析trap信息,配置准确告警（以RFC1628.MIB为例) 以下是进阶配置，将告警信息中的MIB oid翻译为对应的name，以触发准确的trap告警。 确定mib文件路径\n1 2 net-snmp-config --default-mibdirs /root/.snmp/mibs:/usr/share/snmp/mibs 将RFC1628.MIB文件上传至/usr/share/snmp/mibs,格式可以保持RFC1628.MIB,也可以RFC1628-MIB.txt.\nsnmptrap此时仍未解析，客户端测试（其中.1.3.6.1.2.1.33.1.6.3.21=upsAlarmAwaitingPower):\n1 2 snmptrap -v 1 -c public zabbix-ip 1.3.6.1.2.1.33 zabbix-ip 6 0 999 1.3.6.1.2.1.33.1.6.3.21 s snmptrap-test-v1 snmptrap -v 2c -c public zabbix-ip \u0026#39;\u0026#39; .1.3.6.1.2.1.33.1.6.3.21 .1.3.6.1.2.1.33.1.6.3.21 s \u0026#39;snmptrap test-v2\u0026#39; zabbix告警数据:\n1 SNMPv2-SMI::mib-2.33.1.6.3.21 type=4 value=STRING: \u0026#34;snmptrap-test-v1\u0026#34; 修改snmptrapd配置文件，加载新增的MIB库或全部MIB库\n1 vim /usr/lib/systemd/system/snmptrapd.service 1 ExecStart=/usr/sbin/snmptrapd $OPTIONS -f -m /usr/share/snmp/mibs/RFC1628.MIB 或\n1 ExecStart=/usr/sbin/snmptrapd $OPTIONS -f -m ALL 重启snmptrapd\n1 2 systemctl daemon-reload systemctl restart snmptrapd 客户端重新测试\n1 2 snmptrap -v 1 -c public zabbix-ip 1.3.6.1.2.1.33 zabbix-ip 6 0 999 1.3.6.1.2.1.33.1.6.3.21 s snmptrap-test-v1 snmptrap -v 2c -c public zabbix-ip \u0026#39;\u0026#39; .1.3.6.1.2.1.33.1.6.3.21 .1.3.6.1.2.1.33.1.6.3.21 s \u0026#39;snmptrap test-v2\u0026#39; zabbix告警数据可以看到upsAlarmAwaitingPower字段\n1 UPS-MIB::upsAlarmAwaitingPower type=4 value=STRING: \u0026#34;snmptrap-test-v1\u0026#34; 4.创建准确解析的trap监控项 创建监控项\n1 2 3 4 5 6 名称：SNMP traps (upsAlarmAwaitingPower) 类型：SNMP trap 键值：snmptrap[UPS-MIB::upsAlarmAwaitingPower] 信息类型：日志 日志时间格式：hh:mm:sszyyyy/MM/dd # 键值配置为snmptrap[UPS-MIB::upsAlarmAwaitingPower]，可以接收所有匹配了UPS-MIB::upsAlarmAwaitingPower的trap信息 创建触发器,只要接受到新的UPS-MIB::upsAlarmAwaitingPower trap信息就触发告警\n1 2 3 触发器名称 snmptrap event-upsAlarmAwaitingPower 表达式 length(last(/UPS RFC 1628 SNMP/snmptrap[UPS-MIB::upsAlarmAwaitingPower]))\u0026gt;0 允许手动关闭 附：RFC1628 Trap\nTRAPS Description Comments upsAlarmBatteryBad 电池故障 .1.3.6.1.2.1.33.1.6.3.1 upsAlarmOnBattery 电池模式 .1.3.6.1.2.1.33.1.6.3.2 upsAlarmLowBattery 电池低告警 .1.3.6.1.2.1.33.1.6.3.3 upsAlarmDepletedBattery 电池未接或电池耗尽 .1.3.6.1.2.1.33.1.6.3.4 upsAlarmTempBad 温度异常 .1.3.6.1.2.1.33.1.6.3.5 upsAlarmInputBad 输入异常 .1.3.6.1.2.1.33.1.6.3.6 upsAlarmOutputBad 输出异常 .1.3.6.1.2.1.33.1.6.3.7 upsAlarmOutputOverload 输出过载 .1.3.6.1.2.1.33.1.6.3.8 upsAlarmOnBypass 旁路模式 .1.3.6.1.2.1.33.1.6.3.9 upsAlarmBypassBad 旁路异常 .1.3.6.1.2.1.33.1.6.3.10 upsAlarmOutputOffAsRequested 按要求的UPS输出关闭 .1.3.6.1.2.1.33.1.6.3.11 upsAlarmUpsOffAsRequested 按要求的UPS系统关闭 .1.3.6.1.2.1.33.1.6.3.12 upsAlarmChargerFailed 充电故障 .1.3.6.1.2.1.33.1.6.3.13 upsAlarmUpsOutputOff UPS输出关闭 .1.3.6.1.2.1.33.1.6.3.14 upsAlarmUpsSystemOff UPS系统关闭 .1.3.6.1.2.1.33.1.6.3.15 upsAlarmFanFailure 风扇故障 .1.3.6.1.2.1.33.1.6.3.16 upsAlarmFuseFailure 保险丝熔断或故障 .1.3.6.1.2.1.33.1.6.3.17 upsAlarmGeneralFault UPS故障 .1.3.6.1.2.1.33.1.6.3.18 upsAlarmDiagnosticTestFailed 测试诊断失败 .1.3.6.1.2.1.33.1.6.3.19 upsAlarmCommunicationsLost 通讯失败 .1.3.6.1.2.1.33.1.6.3.20 upsAlarmAwaitingPower 市电异常 .1.3.6.1.2.1.33.1.6.3.21 upsAlarmShutdownPending 关机延迟 .1.3.6.1.2.1.33.1.6.3.22 upsAlarmShutdownImminent 立即关机 .1.3.6.1.2.1.33.1.6.3.23 upsAlarmTestInProgress 电池测试中 .1.3.6.1.2.1.33.1.6.3.24 emdTemperatureTooHigh 温度过高 .1.3.6.1.2.1.33.1.6.3.26 emdTemperatureTooLow 温度过低 .1.3.6.1.2.1.33.1.6.3.27 emdHumidityTooHigh 湿度过高 .1.3.6.1.2.1.33.1.6.3.28 emdHumidityTooLow 湿度过低 .1.3.6.1.2.1.33.1.6.3.29 emdAlarm1Active 告警一使能 .1.3.6.1.2.1.33.1.6.3.30 emdAlarm2Active 告警二使能 .1.3.6.1.2.1.33.1.6.3.31 读故障不是读上面的每个OID，而是读右边两个 upsAlarmDescr告警描述 .1.3.6.1.2.1.33.1.6.2.1.2 upsAlarmTime告警时间 .1.3.6.1.2.1.33.1.6.2.1.3 ","date":"2025-02-16T14:00:00+08:00","permalink":"https://kingslayermeto.githun.io/p/zabbix6.0%E6%8E%A5%E6%94%B6snmptrap%E8%A7%A6%E5%8F%91%E5%91%8A%E8%AD%A6%E8%A7%A3%E6%9E%90rfc1628%E7%9A%84trap%E4%BF%A1%E6%81%AF/","title":"zabbix6.0接收snmptrap,触发告警,解析RFC1628的trap信息"},{"content":"1.检查是否使用PAM认证模块禁止wheel组之外的用户su为root\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 vim /etc/pam.d/su #%PAM-1.0 auth required pam_env.so auth sufficient pam_rootok.so auth required pam_wheel.so group=wheel # Uncomment the following line to implicitly trust users in the \u0026#34;wheel\u0026#34; group. #auth sufficient pam_wheel.so trust use_uid # Uncomment the following line to require a user to be in the \u0026#34;wheel\u0026#34; group. #auth required pam_wheel.so use_uid auth substack system-auth auth include postlogin account sufficient pam_succeed_if.so uid = 0 use_uid quiet account include system-auth password include system-auth session include system-auth session include postlogin session optional pam_xauth.so 1 usermod -G wheel root 2.检查重要目录或文件权限设置\n1 2 3 chmod 644 /etc/security chmod 600 /etc/grub2.cfg chmod 600 /boot/grub2/grub.cfg 3.检查是否修改snmp默认团体字 （如安装了snmp相关工具）\n1 vim /etc/snmp/snmpd.conf 修改默认community public为其他值\n4.检查用户umask设置,设置 umask 022\n1 2 3 vim /etc/csh.cshrc vim /etc/csh.login vim /etc/profile 5.是否设置ssh登录前警告Banner\n1 2 3 4 5 6 7 8 9 touch /etc/ssh_banner chown bin:bin /etc/ssh_banner chmod 644 /etc/ssh_banner echo \u0026#34; Authorized only. All activity will be monitored and reported \u0026#34; \u0026gt; /etc/ssh_banner vim /etc/ssh/sshd_config Banner /etc/ssh_banner systemctl restart sshd 6.检查别名文件/etc/aliase（或/etc/mail/aliases）配置 ,删除或注释掉下面的行\n1 2 vim /etc/aliases vim /etc/mail/aliases 1 2 3 4 5 6 7 8 9 10 #games: root #ingres: root #system: root #toor: root #uucp: root #manager: root #dumper: root #operator: root #decode: root #root: marc 补充操作说明 更新后运行/usr/bin/newaliases，使改变生效\n7.检查设备密码复杂度策略\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 vim /etc/pam.d/system-auth中应当使用pam_pwquality.so # Generated by authselect on Mon Sep 4 07:59:35 2023 # Do not modify this file manually. auth required pam_env.so auth required pam_faildelay.so delay=2000000 auth required pam_faillock.so preauth audit deny=5 even_deny_root unlock_time=600 -auth sufficient pam_fprintd.so auth sufficient pam_fprintd.so auth [default=1 ignore=ignore success=ok] pam_usertype.so isregular auth [default=1 ignore=ignore success=ok] pam_localuser.so auth sufficient pam_unix.so nullok try_first_pass -auth sufficient pam_sss.so use_first_pass auth [default=1 ignore=ignore success=ok] pam_usertype.so isregular auth sufficient pam_sss.so forward_pass auth [default=die] pam_faillock.so authfail audit deny=5 even_deny_root unlock_time=600 auth required pam_deny.so auth sufficient pam_faillock.so authsucc audit deny=5 even_deny_root unlock_time=600 account required pam_faillock.so account required pam_unix.so account sufficient pam_localuser.so account sufficient pam_usertype.so issystem account [default=bad success=ok user_unknown=ignore] pam_sss.so account required pam_permit.so password requisite pam_pwquality.so local_users_only ucredit=-1 lcredit=-1 dcredit=-1 ocredit=-1 minlen=8 password sufficient pam_unix.so sha512 shadow nullok use_authtok remember=5 password sufficient pam_sss.so use_authtok password required pam_deny.so session optional pam_keyinit.so revoke session required pam_limits.so -session optional pam_systemd.so session [success=1 default=ignore] pam_succeed_if.so service in crond quiet use_uid session required pam_unix.so session optional pam_sss.so vim /etc/security/pwquality.conf中minclass不小于3 8.检查口令最小长度(实际无作用，仅用于检查合规）\n1 2 vim /etc/login.defs PASS_MIN_LEN 8 9.polkit安全配置\n1 chmod 0755 /usr/bin/pkexec 10.检查是否配置远程日志功能\n1 2 vim /etc/rsyslog.conf *.info @syslog-ip 11.检查是否使用NTP（网络时间协议）保持时间同步\n1 2 vim /etc/chrony.conf server svrip iburst 12.检查是否设置命令行界面超时退出\n1 2 vim /etc/profile export TMOUT=900 ","date":"2025-02-06T15:00:00+08:00","permalink":"https://kingslayermeto.githun.io/p/rockylinux9.5%E9%BB%98%E8%AE%A4%E5%AE%89%E8%A3%85%E5%90%8E%E8%BF%9B%E8%A1%8C%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/","title":"rockylinux9.5默认安装后进行安全加固"},{"content":"zabbix发送短信有两种模式:\n1.使用管理-媒介-短信功能 需要使用串口或USB接口的短信modem，官方支持的型号有Siemens MC35、Teltonika ModemCOM/G10，默认端口/dev/ttyS0，在驱动正常的情况下直接调用串口AT指令。\n2.使用管理-媒介-脚本 本方式下服务器为虚拟机，，对接短信平台、或网口短信终端。 以网口短信终端JY311为例，python脚本SMS.py如下\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 #!/usr/bin/python # _*_ coding:utf8 _*_ import socket,time,sys sento = sys.argv[1] subject = sys.argv[2] message = sys.argv[3] #从zabbix传递的三个参数，对应{ALERT.SENDTO},{ALERT.SUBJECT},{ALERT.MESSAGE} client=socket.socket() addr=(ip,port) #网口短信终端的ip，以及短信终端工作在TPC服务器模式下的端口 client.connect(addr) myinput =(\u0026#39;%s:0:\u0026lt;%s\u0026gt;\\n%s\u0026#39;%(sento,subject,message)).encode(\u0026#34;GBK\u0026#34;) #发送数据 #client.send(data.encode(\u0026#39;utf-8\u0026#39;)) print(myinput) print(len(myinput)) client.send(myinput) time.sleep(5) client.close() JY311网口短信终端的接口很容易实现（编码方式0短信，编码方式3语音）： 目标手机号码 分隔符 编码方式 分隔符 短消息内容\n1 8613102859936:0:hello，这是一条测试短信 1 8613102859936:3:hello，这是一条测试语音 ","date":"2025-02-06T14:59:00+08:00","permalink":"https://kingslayermeto.githun.io/p/zabbix%E9%85%8D%E5%90%88%E7%BD%91%E5%8F%A3%E7%9F%AD%E4%BF%A1%E7%BB%88%E7%AB%AF%E5%8F%91%E9%80%81%E7%9F%AD%E4%BF%A1%E5%A4%87/","title":"zabbix配合网口短信终端发送短信备"},{"content":"从zabbix6.0开始，modbus成为了官方的默认集成，modbus协议广泛的用于工业设备。 本文前提:zabbix6.0服务器,zabbix 6.0 agent2主机,一个运行modbus slave软件（一款modbus仿真软件，本例中用其输出modbus tcp协议）的windows主机 本文物理连接及协议参考：SCA精密空调机组通信协议 借助串口服务器，将modbus rtu协议转换为modbus tcp协议。\n1.检查agent2主机的zabbix agent2的配置文件\n1 /etc/zabbix/zabbix_agent2.conf 默认应有\n1 Include=/etc/zabbix/zabbix_agent2.d/*.conf 2.编辑agent的配置文件或插件配置文件\n1 vim /etc/zabbix/zabbix_agent2.d/plugins.d/modbus.conf 定义以下参数:\n1 2 3 Plugins.Modbus.Sessions.\u0026lt;SessionName\u0026gt;.Endpoint Plugins.Modbus.Sessions.\u0026lt;SessionName\u0026gt;.SlaveID Plugins.Modbus.Timeout 举例(slaveip换成运行modbus slave的windows客户端主机ip)\n1 2 3 Plugins.Modbus.Sessions.MB1.Endpoint=tcp://slaveip:502 Plugins.Modbus.Sessions.MB1.SlaveID=1 Plugins.Modbus.Sessions.MB1.Timeout=3 3.zabbix服务器添加此agent2主机，同时自定义modbus监控项 官方参数\n1 modbus.get[endpoint,\u0026lt;slaveid\u0026gt;,\u0026lt;function\u0026gt;,\u0026lt;address\u0026gt;,\u0026lt;count\u0026gt;,\u0026lt;type\u0026gt;,\u0026lt;endianness\u0026gt;,\u0026lt;offset\u0026gt;] 以添加上述slave id 1的modbus slave为例，在agent2主机中创建监控项。 SCA空调机组通信协议为例\n1 2 3 4 #监控项 PAC1-modbus-slaveid1-addr40001-开关机 #键值 modbus.get[MB1,2,3,0,1,uint16,be,0] 1 2 3 4 #监控项 PAC1-modbus-slaveid1-addr40003-设定回风温度 #键值 modbus.get[MB1,2,3,0,1,uint16,be,1] 1 2 3 4 #监控项 PAC1-modbus-slaveid1-addr40004-系统状态 #键值 modbus.get[MB1,2,3,0,1,uint16,be,3] 1 2 3 4 5 6 7 8 9 10 11 #监控项 #PAC1-modbus-slaveid1-addr40004-系统状态-bitx-功能X PAC1-modbus-slaveid1-addr40004-系统状态-bit00-开机 #类型 可计算的 #键值 PAC1-modbus-slaveid1-addr40004-bit00 #公式（判断Bit x是否为1，按位与2的x次幂，然后按位右移x位） #公式（判断Bit00是否为1，按位与2的0次幂，然后按位右移0位） #bitrshift(bitand(last(//modbus.get[MB1,2,3,0,1,uint16,be,3]),power(2,x)),x) bitrshift(bitand(last(//modbus.get[MB1,2,3,0,1,uint16,be,3]),power(2,0)),0) 1 2 3 4 5 6 7 8 #监控项 PAC1-modbus-slaveid1-addr40004-系统状态-bit03-制冷 #类型 可计算的 #键值 PAC1-modbus-slaveid1-addr40004-bit03 #公式（判断Bit03是否为1，按位与2的3次幂，然后按位右移3位） bitrshift(bitand(last(//modbus.get[MB1,2,3,0,1,uint16,be,3]),power(2,3)),3) 1 2 3 4 #监控项,单位：小时（16比特位向左移动4位+运行时间低位向右移动12位） PAC1-modbus40016-风机运行时间高位 #键值 modbus.get[MB1,2,3,0,1,uint16,be,15] 1 2 3 4 #监控项,单位：秒（低12bit位） PAC1-modbus40017-风机运行时间低位 #键值 modbus.get[MB1,2,3,0,1,uint16,be,16] 1 2 3 4 5 6 7 8 #监控项,单位:秒，上述两项相加 PAC1-modbus40016-风机运行时间 #类型 可计算的 #键值 modbus-slave1-addr40016 #公式 bitor(bitlshift(last(//modbus.get[MB1,1,3,0,1,uint16,be,15]),4),bitrshift(last(//modbus.get[MB1,1,3,0,1,uint16,be,16]),12))*3600+bitand(last(//modbus.get[MB1,1,3,0,1,uint16,be,16]),4095) ","date":"2025-02-06T14:58:00+08:00","permalink":"https://kingslayermeto.githun.io/p/%E5%BC%80%E6%BA%90%E5%8A%A8%E7%8E%AF%E7%9B%91%E6%8E%A7%E4%BD%BF%E7%94%A8zabbix-6.0-%E7%9A%84agent2%E7%9B%91%E6%8E%A7%E7%B2%BE%E5%AF%86%E7%A9%BA%E8%B0%83%E7%AD%89modbus%E8%AE%BE%E5%A4%87/","title":"开源动环监控——使用zabbix 6.0 的agent2监控精密空调等modbus设备"},{"content":"注意：moodle有windows版，优点解压即用，缺点不是很稳定。（解压、运行、直接到本文末第7步配置） 本文档是关于在使用 PHP 7.4 的 Ubuntu 20.04 服务器中安装 Moodle 4.0.12的简化版\n1、安装ubuntu20.04LTS服务器版，安装时使用国内源如\n1 http://mirrors.aliyun.com/ubuntu 安装vim\n1 sudo apt-get install vim 2、安装 Apache/MySQL/PHP\n1 sudo apt install apache2 mysql-client mysql-server php7.4 libapache2-mod-php 运行sudo mysql_secure_installation时务必记住密码（示例中的yourpassword）\n1 2 3 4 5 6 7 8 sudo mysql_secure_installation sudo cat /etc/mysql/debian.cnf mysql -u debian-sys-maint -p \u0026gt;select user, plugin from mysql.user; \u0026gt;use mysql; \u0026gt;ALTER USER root@localhost IDENTIFIED WITH mysql_native_password BY \u0026#39;yourpassword\u0026#39;; \u0026gt;FLUSH PRIVILEGES; \u0026gt;EXIT; 3、安装其他软件\n1 sudo apt install graphviz aspell ghostscript clamav php7.4-pspell php7.4-curl php7.4-gd php7.4-intl php7.4-mysql php7.4-xml php7.4-xmlrpc php7.4-ldap php7.4-zip php7.4-soap php7.4-mbstring 重启apache\n1 sudo service apache2 restart 4、下载安装moodle 下载moodle4.0.12\n1 2 3 4 5 6 cd /var/www/html/ sudo tar -xzvf moodle-4.0.12.tgz sudo mkdir /var/moodledata sudo chown -R www-data /var/moodledata sudo chmod -R 777 /var/moodledata sudo chmod -R 0755 /var/www/html/moodle 5、设置mysql服务器（示例中DATABASE name=moodle, DATABASE user=moodleuser,yourpassword自行替换）\n1 2 3 4 5 sudo mysql -u root -p \u0026gt;CREATE DATABASE moodle DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci; \u0026gt;create user moodleuser@localhost IDENTIFIED BY \u0026#39;yourpassword\u0026#39;; \u0026gt;GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,CREATE TEMPORARY TABLES,DROP,INDEX,ALTER ON moodle.* TO moodleuser@localhost; \u0026gt;exit; 6、配置权限，继续在web完成配置\n1 sudo chmod -R 777 /var/www/html/moodle 记得配置完后恢复权限，使得Moodle设置不再可以写入。\n1 sudo chmod -R 0755 /var/www/html/moodle 7、浏览器转到配置界面，根据第4、5步实际参数完成配置\n1 http://ip.address.of.server/moodle 附：建议使用Gift格式批量导入题库:\n1 2 3 4 ::Q1::单选题题干{~A=B~C~D####解析} ::Q2::多选题题干{~%33.33333%A~%33.33333%B~%33.33333%C~%-100%~####解析} ::Q3::判断题题干{T####解析} ::Q4::填空题题干{=答案####解析} ","date":"2025-02-06T14:57:00+08:00","permalink":"https://kingslayermeto.githun.io/p/%E8%87%AA%E5%BB%BA%E5%BC%80%E6%BA%90%E5%AD%A6%E4%B9%A0%E8%80%83%E8%AF%95%E7%B3%BB%E7%BB%9F-moodle/","title":"自建开源学习考试系统-moodle"},{"content":"rockylinux9.2: 创建目录，挂载iso镜像\n1 2 3 mkdir /media/iso mount /dev/cdrom /media/iso 备份源\n1 2 3 4 5 6 cd /etc/yum.repos.d cp rocky.repo rocky.repo.bak cp rocky-extras.repo rocky-extras.repo.bak 创建镜像源\n1 2 cat media/iso/media.repo \u0026gt; /etc/yum.repos.d/media.repo 编辑镜像源\n1 2 3 4 5 6 7 8 9 10 11 12 [InstallMedia-AppStream] name=Rocky Linux 9.2 baseurl=file:///media/iso/AppStream gpgcheck=0 enabled=1 [InstallMedia-BaseOS] name=Rocky Linux 9.2 baseurl=file:///media/iso/BaseOS gpgcheck=0 enabled=1 centos7.9: 创建本地源\n1 2 3 4 5 mkdir /media/centos mount /dev/cdrom /media/centos cp -rf /etc/yum.repos.d /etc/yum.repos.d_$(date \u0026#39;+%Y%m%d_%H%M%S\u0026#39;) rm -rf /etc/yum.repos.d/* vi /etc/yum.repos.d/Media.repo 1 2 3 4 5 [base] name=Media baseurl=file:///media/centos/ gpgcheck=0 enabled=1 清除yum缓存\n1 yum clean all 缓存本地yum源\n1 yum makecache 测试yum本地源\n1 yum list ","date":"2025-02-06T14:56:00+08:00","permalink":"https://kingslayermeto.githun.io/p/rockylinux9.2-centos7.9%E9%85%8D%E7%BD%AE%E6%9C%AC%E5%9C%B0%E9%95%9C%E5%83%8F%E6%BA%90/","title":"rockylinux9.2 \u0026centos7.9配置本地镜像源"},{"content":"方法一： 准备工具\n0.Windows10(自带powershell5.0)\n1.VM官网powercli(12.0.0)，解压到C:\\Program Files\\WindowsPowerShell\\Modules https://developer.broadcom.com/tools/vmware-powercli/12.0.0\n2.VM官网ESXi离线捆绑包(.zip格式)\nVMware vSphere Hypervisor (ESXi) Offline Bundle\n3.ESXi-Customizer-PS-v2.6.0.ps1\nhttps://www.v-front.de/p/esxi-customizer-ps.html#download\n4.需要封装的vib驱动 参考网址，注意2018年停更 https://vibsdepot.v-front.de/wiki/index.php/List_of_currently_available_ESXi_packages 以待封装驱动为例： Intel-Volume-Mgmt-Device_2.7.1.1002-1OEM.670.0.0.8169922-18273401.zip\n步骤:\n管理员运行powershell\n1 2 Set-ExecutionPolicy RemoteSigned 1 2 Import-Module VMware.PowerCLI 1 2 Set-PowerCLIConfiguration -Scope AllUsers -ParticipateInCeip $false -InvalidCertificateAction Ignore 进入准备阶段2.3.4文件所在的目录 以待封装驱动为例Intel-Volume-Mgmt-Device_2.7.1.1002-1OEM.670.0.0.8169922-18273401.zip\n1 2 .\\ESXi-Customizer-PS-v2.6.0.ps1 -izip ESXi670-201912001.zip -pkgdir Intel-Volume-Mgmt-Device_2.7.1.1002-1OEM.670.0.0.8169922-18273401.zip 回显All done完成:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 PS C:\\esxi\u0026gt; .\\ESXi-Customizer-PS-v2.6.0.ps1 -izip ESXi670-201912001.zip -pkgdir Intel-Volume-Mgmt-Device_2.7.1.1002-1OEM.670.0.0.8169922-18273401.zip This is ESXi-Customizer-PS Version 2.6.0 (visit https://ESXi-Customizer-PS.v-front.de for more information!) (Call with -help for instructions) Logging to C:\\Users\\meto\\AppData\\Local\\Temp\\ESXi-Customizer-PS-11808.log ... Running with PowerShell version 5.1 and VMware PowerCLI version 12.0.0.15939655 Adding base Offline bundle ESXi670-201912001.zip ... [OK] Getting Imageprofiles, please wait ... [OK] Using Imageprofile ESXi-6.7.0-20191204001-standard ... (dated 11/25/2019 11:43:03, AcceptanceLevel: PartnerSupported, Updates ESXi 6.7 Image Profile-ESXi-6.7.0-20191204001-standard) Loading Offline bundles and VIB files from Intel-Volume-Mgmt-Device_2.7.1.1002-1OEM.670.0.0.8169922-18273401.zip ... Exporting the Imageprofile to \u0026#39;C:\\esxi\\ESXi-6.7.0-20191204001-standard-customized.iso\u0026#39;. Please be patient ... All done. 方法二：以浪潮厂家提供文档为例 http://www.4008600011.com/archives/15441#VMwareraid\n","date":"2025-02-06T14:55:00+08:00","permalink":"https://kingslayermeto.githun.io/p/esxi6.7%E5%B0%81%E8%A3%85%E9%A9%B1%E5%8A%A8/","title":"ESXi6.7封装驱动"},{"content":" df(disk free) 命令用于显示目前在 Linux 系统上的文件系统磁盘使用情况统计。 文件-h, \u0026ndash;human-readable 使用人类可读的格式(预设值是不加这个选项的)。 1 2 3 4 5 6 7 8 9 10 # df -h Filesystem Size Used Avail Use% Mounted on /dev/mapper/centos-root 17G 4.4G 13G 26% / devtmpfs 2.0G 0 2.0G 0% /dev tmpfs 2.0G 0 2.0G 0% /dev/shm tmpfs 2.0G 9.1M 2.0G 1% /run tmpfs 2.0G 0 2.0G 0% /sys/fs/cgroup /dev/sda1 1014M 161M 854M 16% /boot tmpfs 394M 4.0K 394M 1% /run/user/42 tmpfs 394M 32K 394M 1% /run/user/0 du(disk usage)命令用于显示目录或文件的大小。 -h或\u0026ndash;human-readable 以K，M，G为单位，提高信息的可读性。 -X\u0026lt;文件\u0026gt;或\u0026ndash;exclude-from=\u0026lt;文件\u0026gt; 在\u0026lt;文件\u0026gt;指定目录或文件。 显示test目录下面的子目录的目录大小和test目录的总的大小，最下面的1.3M为test目录的总大小。 1 2 3 4 5 6 7 8 9 10 11 12 13 # du -h test 608K test/test6 308K test/test4 4.0K test/scf/lib 4.0K test/scf/service/deploy/product 4.0K test/scf/service/deploy/info 12K test/scf/service/deploy 16K test/scf/service 4.0K test/scf/doc 4.0K test/scf/bin 32K test/scf 8.0K test/test3 1.3M test fdisk 是一个创建和维护分区表的程序，它兼容 DOS 类型的分区表、BSD 或者 SUN 类型的磁盘列表。 -l 列出素所有分区表。 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 # fdisk -l Disk /dev/sda: 21.5 GB, 21474836480 bytes, 41943040 sectors Units = sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disk label type: dos Disk identifier: 0x00092469 Device Boot Start End Blocks Id System /dev/sda1 * 2048 2099199 1048576 83 Linux /dev/sda2 2099200 41943039 19921920 8e Linux LVM WARNING: fdisk GPT support is currently new, and therefore in an experimental phase. Use at your own discretion. Disk /dev/sdb: 8796.1 GB, 8796093022208 bytes, 17179869184 sectors Units = sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disk label type: gpt Disk identifier: E9DB1E69-E857-400F-8653-F45B587FCAB2 # Start End Size Type Name 1 2048 17179867136 8T unknown Disk /dev/mapper/centos-root: 18.2 GB, 18249416704 bytes, 35643392 sectors Units = sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes Disk /dev/mapper/centos-swap: 2147 MB, 2147483648 bytes, 4194304 sectors Units = sectors of 1 * 512 = 512 bytes Sector size (logical/physical): 512 bytes / 512 bytes I/O size (minimum/optimal): 512 bytes / 512 bytes lsblk 列出所有可用块设备的信息，而且还能显示他们之间的依赖关系，但是它不会列出RAM盘的信息。 块设备有硬盘，闪存盘，cd-ROM等等。 1 2 3 4 5 6 7 8 9 10 # lsblk NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT sda 8:0 0 20G 0 disk ├─sda1 8:1 0 1G 0 part /boot └─sda2 8:2 0 19G 0 part ├─centos-root 253:0 0 17G 0 lvm / └─centos-swap 253:1 0 2G 0 lvm [SWAP] sdb 8:16 0 8T 0 disk └─sdb1 8:17 0 8T 0 part sr0 11:0 1 1024M 0 rom ","date":"2025-02-06T14:54:53+08:00","permalink":"https://kingslayermeto.githun.io/p/dfdufdisklsblk%E5%8C%BA%E5%88%AB/","title":"df、du、fdisk、lsblk区别"},{"content":"Github page+Hugo+stack theme\n","date":"2025-02-04T14:33:53+08:00","permalink":"https://kingslayermeto.githun.io/p/myfirstblog/","title":"MyFirstBlog"}]